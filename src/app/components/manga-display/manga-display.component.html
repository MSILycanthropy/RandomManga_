<ng-container *ngIf="manga; then thenTemplate; else elseTemplate"></ng-container>
<ng-template #thenTemplate>
  <mat-card class="primary center-10 mangaCard">
    <div style="display: flex">
      <div class="gray" style="padding-right: 1em">
        <img [src]="_DomSanitizer.bypassSecurityTrustUrl(url)" width="240" height="320" style="display: block" class="showAbove" />
      </div>

      <div class="titleTile">
        <div>
          <div class="titleWrapper">
            <div class="title">
              <h3 class="header showAbove">
                {{ manga.Title }}
              </h3>
              <mat-divider style="position: relative"></mat-divider>
            </div>

            <span style="margin-left: auto">
              <button class="addToList showAbove" title="Add to List" (click)="sorryModal.create()">
                <fa-icon [icon]="faPlusCircle" size="2x"></fa-icon>
              </button>
            </span>
          </div>

          <div style="display: flex; flex-flow: column">
            <ng-container *ngIf="manga.Genres; else genresElse">
              <div class="extraTitleContent showAbove fitContent">
                {{ manga.Genres.join(", ") }}
              </div>
            </ng-container>
            <ng-template #genresElse>
              <div class="extraTitleContent showAbove fitContent">No known genres</div>
            </ng-template>

            <ng-container *ngIf="manga.Authors; else authorsElse">
              <div class="extraTitleContent showAbove fitContent" style="font-size: 1em; margin-top: 0">
                <span *ngFor="let author of manga.Authors; let i = index">
                  <span *ngIf="author['name']['last']">{{ author["name"]["last"] }},&nbsp;</span>{{ author["name"]["first"]
                  }}<span *ngIf="i != manga.Authors.length - 1">;&nbsp;</span>
                </span>
              </div>
            </ng-container>
            <ng-template #authorsElse>
              <div class="extraTitleContent showAbove fitContent">No known authors</div>
            </ng-template>
          </div>
        </div>

        <div class="moreInfoTile">
          <div class="moreInfoTop">
            <expando-card #expando class="expandoCard">
              <div title class="showAbove fitContent">Country of Origin</div>
              <div class="matchJapaneseHeight showAbove fitContent" content>
                {{ manga.Type || "N/A" }}
              </div>
            </expando-card>
            <expando-card #expando class="expandoCard">
              <div title class="showAbove fitContent">Volumes</div>
              <div class="matchJapaneseHeight showAbove fitContent" content>
                {{ manga.Volumes || "N/A" }}
              </div>
            </expando-card>
            <expando-card #expando class="expandoCard">
              <div title class="showAbove fitContent">Chapters</div>
              <div class="matchJapaneseHeight showAbove fitContent" content>
                {{ manga.Chapters || "N/A" }}
              </div>
            </expando-card>
            <!-- <expando-card #expando class="expandoCard">
              <div title class="showAbove fitContent">Authors</div>
              <div class="matchJapaneseHeight showAbove fitContent" content>
                {{ manga.Authors.join("; ") || "N/A" }}
              </div>
            </expando-card> -->
          </div>
          <div>
            <expando-card #expando class="expandoCard">
              <div title class="showAbove fitContent">Score</div>
              <div class="matchJapaneseHeight showAbove fitContent" content [innerHTML]="manga.Score || 'N/A'"></div>
            </expando-card>
            <expando-card #expando class="expandoCard">
              <div title class="showAbove fitContent">Start</div>
              <div class="matchJapaneseHeight showAbove fitContent" content>
                {{ manga.Start["month"] ? manga.Start["month"] + " -" : "" }}
                {{ manga.Start["day"] ? manga.Start["day"] + " -" : "" }}
                {{ manga.Start["year"] ? manga.Start["year"] : "" || "N/A" }}
              </div>
            </expando-card>
            <expando-card #expando class="expandoCard">
              <div title class="showAbove fitContent">End</div>
              <div class="matchJapaneseHeight showAbove fitContent" content>
                {{ manga.End["month"] ? manga.End["month"] + " -" : "" }}
                {{ manga.End["day"] ? manga.End["day"] + " -" : "" }}
                {{ manga.End["year"] ? manga.End["year"] : "" || "N/A" }}
              </div>
            </expando-card>
          </div>
        </div>
      </div>
    </div>
    <div class="descriptionTile">
      <div class="descriptionWrapper">
        <div style="width: fit-content">
          <h3 class="header synopsisHeader showAbove">Synopsis</h3>
          <mat-divider style="position: relative"></mat-divider>
        </div>
        <p class="synopsisText showAbove" style="line-height: 1.5em" [innerHTML]="manga.Synopsis || 'None.'"></p>
        <button *ngIf="!manga.Synopsis" mat-button (click)="setReportAndRoute()" class="showAbove">Suggest a Synopsis</button>
      </div>
    </div>

    <div class="descriptionTile">
      <div class="descriptionWrapper" style="margin-top: 1em">
        <div style="width: fit-content">
          <h3 class="header synopsisHeader showAbove">Synonyms</h3>
          <mat-divider style="position: relative"></mat-divider>
        </div>
        <ng-container *ngIf="manga.Synonyms; else synonymsElse">
          <ul>
            <li class="showAbove fitContent" *ngFor="let synonym of manga.Synonyms">
              {{ synonym }}
            </li>
          </ul>
        </ng-container>
        <ng-template #synonymsElse>
          <p style="line-height: 1.5em; padding-left: 1em; margin: 0" class="showAbove fitContent">No known synonyms.</p>
        </ng-template>
      </div>
    </div>

    <div class="shareWrapper">
      <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Frngmanga.com%2F&amp;src=sdkpreparse" class="showAbove">
        <fa-icon [icon]="faFacebook" class="shareIcon"></fa-icon>
      </a>
      <a href="https://twitter.com/intent/tweet?text=https%3A%2F%2Frngmanga.com" class="showAbove">
        <fa-icon [icon]="faTwitter" class="shareIcon"></fa-icon>
      </a>
      <a href="http://www.reddit.com/submit?url=https%3A%2F%2Frngmanga.com" class="showAbove">
        <fa-icon [icon]="faReddit" class="shareIcon"></fa-icon>
      </a>
      <a href="http://tumblr.com/widgets/share/tool?canonicalUrl=https%3A%2F%2Frngmanga.com" class="showAbove">
        <fa-icon [icon]="faTumblr" class="shareIcon"></fa-icon>
      </a>
      <button mat-button (click)="setReportAndRoute()" class="errorButton showAbove">Report Error</button>
    </div>
  </mat-card>
  <modal-popup [width]="380" [background]="'#212121'" #sorryModal class="sorryModal">
    <h3 class="sorryTitle" title>Sorry this feature is not yet added!</h3>
    <div class="sorryContent" content>
      <div class="sorryText">
        It requires things I currently do not have the means to do. If you are able to, please support so that these features can be added. Thank you
        for using RNGmanga.
      </div>

      <div class="sorryIcons">
        <a
          inlineSVG="../assets/PayPal.svg"
          class="donationSVG"
          href="https://www.paypal.com/donate/?business=8TNF3RZ45CHRW&item_name=RNGmanga+contribution&currency_code=USD&Z3JncnB0="
          target="_blank"
        ></a>
        <a inlineSVG="../assets/BMC.svg" class="donationSVG" href="https://www.buymeacoffee.com/msilycanthropy" target="_blank"></a>
      </div>
    </div>
  </modal-popup>
</ng-template>
<ng-template #elseTemplate>
  <not-found [error]="'Manga not found'" [num]="420" *ngIf="notFound"></not-found>
</ng-template>
